# ============================================
# Configuration Apache pour Nuxt.js avec Phusion Passenger
# SIMPLIFIED VERSION - PlanetHoster
# ============================================

# ============================================
# PASSENGER CONFIGURATION (MINIMAL)
# ============================================

PassengerEnabled on
PassengerAppRoot /home/fggxbsyg/public_html/new
PassengerAppType node
PassengerStartupFile server.cjs
PassengerNodejs /home/fggxbsyg/nodevenv/public_html/new/22/bin/node
PassengerFriendlyErrorPages on

# Environment
SetEnv NODE_ENV production

# ============================================
# REWRITE RULES
# ============================================

<IfModule mod_rewrite.c>
  RewriteEngine On
  RewriteBase /
  
  # Ne pas rediriger les fichiers réels
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{REQUEST_FILENAME} !-d
  
  # Laisser Passenger gérer toutes les requêtes
  RewriteRule ^(.*)$ / [L]
</IfModule>

# ============================================
# SECURITY HEADERS
# ============================================

<IfModule mod_headers.c>
  Header always set X-Content-Type-Options "nosniff"
  Header always set X-Frame-Options "SAMEORIGIN"
  Header always set X-XSS-Protection "1; mode=block"
  Header unset Server
  Header unset X-Powered-By
</IfModule>

# ============================================
# COMPRESSION
# ============================================

<IfModule mod_deflate.c>
  AddOutputFilterByType DEFLATE text/html text/plain text/xml text/css
  AddOutputFilterByType DEFLATE text/javascript application/javascript application/json
</IfModule>

# ============================================
# FILE ACCESS PROTECTION
# ============================================

<FilesMatch "^\.">
  Order allow,deny
  Deny from all
</FilesMatch>

<FilesMatch "(package\.json|package-lock\.json|\.env|\.git)">
  Order allow,deny
  Deny from all
</FilesMatch>

# Désactiver le listing des répertoires
Options -Indexes
Options +FollowSymLinks
AddDefaultCharset UTF-8
